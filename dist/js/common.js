function setCopyWording(){tradingStyle==STATION_HAUL?(orderTypeStart=$("#buying-type-station").val(),orderTypeEnd=$("#selling-type-station").val()):tradingStyle==REGION_HAUL&&(orderTypeStart=$("#buying-type-region").val(),orderTypeEnd=$("#selling-type-region").val()),"BUY"==orderTypeStart?(regionHeader[1]="Buy Order",regionHeader[4]="At Buy Price",routeHeader[1]="Buy Order",routeHeader[4]="At Buy Price"):(regionHeader[1]="Sell Order",regionHeader[4]="At Sell Price",routeHeader[1]="Sell Order",routeHeader[4]="At Sell Price"),"BUY"==orderTypeEnd?(regionHeader[7]="At Buy Price",routeHeader[7]="At Buy Price"):(regionHeader[7]="At Sell Price",routeHeader[7]="At Sell Price")}function getMarketData(e,t,r,a,o){var n;"string"==typeof e?n=[e]:null!=e&&(n=getBestMarketPrice(e,t,r,a,o));var s=[];if(n)for(var i=0;i<n.length;i++)0<n[i][0]&&s.push(n[i]);return s}function setDefaultVal(e,t){return e&&0<e.length?e:t}function getBestMarketPrice(e,t,r,a,o){for(var n=[],s=0;s<e.length;s++){var i=e[s],l=i.is_buy_order&&r===BUY_ORDER||!i.is_buy_order&&r===SELL_ORDER;if(t==i.location_id&&1===i.min_volume&&l){var d=i.price,u=i.volume_remain;n.push([d,u])}}if(r==SELL_ORDER){var c=o?sellOrderComparator:buyOrderComparator;n=n.sort(c),saveSellOrderData(t,a,$.extend(!0,[],n))}else{c=o?buyOrderComparator:sellOrderComparator;n=n.sort(c),saveBuyOrderData(t,a,$.extend(!0,[],n))}return n}function saveSellOrderData(e,t,r){r&&0<r.length&&(customBuy[e]||(customBuy[e]=[]),!customBuy[e][t]&&0<r.length&&(customBuy[e][t]=r))}function saveBuyOrderData(e,t,r){r&&0<r.length&&(customSell[e]||(customSell[e]=[]),!customSell[e][t]&&0<r.length&&(customSell[e][t]=r))}function sellOrderComparator(e,t){return e[0]>t[0]?-1:e[0]<t[0]?1:0}function buyOrderComparator(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}function bestRowComparator(e,t){return e[5]<t[5]?1:e[5]>t[5]?-1:0}function getStationName(e){var t="";return $.each(endCoordinates,function(){0==t.length&&this.station==e&&(t=this.name)}),t}function displayError(){errorShown||($("#connectEVE").slideToggle(!0),errorShown=!0)}function hideError(){errorShown&&($("#connectEVE").slideToggle(),errorShown=!1)}function numberWithCommas(e){for(;/(\d+)(\d{3})/.test(e.toString());)e=e.toString().replace(/(\d+)(\d{3})/,"$1,$2");return e}function incrementProgress(e,t){getTotalProgress(),e.completePages[t]=!0}function getTotalProgress(){for(var e=0,t=!0,r=0;r<routes.length;r++){t=t&&routes[r].completed,e+=routes[r].recalculateProgress()/routes.length}totalProgress=t?100:100<e?100:e,$(".loading").html("Fetching orders: "+(totalProgress-.01).toFixed(2)+"% complete"),$(".loadingContent").text((totalProgress-.01).toFixed(2)+"%")}function refresh(){$("#refresh-button").remove(),iteration+=1;for(var e=0;e<routes.length;e++)routes[e].clear();customBuy=[],customSell=[],startCoordinates=[],endCoordinates=[],startLocation="",addedToStartList=[],addedToEndList=[],endLocations=[],totalProgress=0,tableCreated=createdRefresher=!(page=1),routes=[],init(tradingStyle)}function isSpamItem(e){for(var t=0;t<spamItems.length;t++)if(0<=e.toLowerCase().indexOf(spamItems[t]))return!0;return!1}function marketEndpointBuilder(e,t,r){return(ESI_ENDPOINT+"/latest/markets/"+e+"/orders/?datasource=tranquility&page="+t+"&order_type="+r+"&language=en-us&iteration="+iteration).replace(/\s/g,"")}function getWeightEndpointBuilder(e){return(ESI_ENDPOINT+"/latest/universe/types/"+e+"/?datasource=tranquility&language=en-us&iteration="+iteration).replace(/\s/g,"")}function getVolumeEndpointBuilder(e,t){return(ESI_ENDPOINT+"/latest/markets/"+e+"/history/?datasource=tranquility&type_id="+t+"&language=en-us&iteration="+iteration).replace(/\s/g,"")}function createTradeHeader(){var e="",t="",r="",a=$("#buyingHeader"),o=$("#buyingFooter"),n=$("#core");if(tradingStyle==STATION_HAUL?($.each(startLocations,function(){this&&(t+=this+", ")}),t=t.substring(0,t.length-2),$.each(endLocations,function(){this&&(r+=this+", ")}),r=r.substring(0,r.length-2)):tradingStyle==REGION_HAUL&&(t=startLocations,r=endLocations),tradingStyle==STATION_HAUL||tradingStyle==REGION_HAUL){"SELL"==orderTypeStart?a.text("Buying Sell Orders from "+t):a.text("Placing Buy Orders at "+t);var s="";s="SELL"==orderTypeEnd?"<div id='route-to'>Selling as Sell Orders at "+r+" at "+sales_tax+"%</div> ROI&nbsp;Greater&nbsp;Than&nbsp;"+threshold_roi+"% |&nbsp;Profits&nbsp;Greater&nbsp;Than&nbsp;"+numberWithCommas(threshold_profit)+"&nbsp;ISK":"<div id='route-to'>Selling to Buy Orders at "+r+" at "+sales_tax+"%</div> ROI&nbsp;Greater&nbsp;Than&nbsp;"+threshold_roi+"% |&nbsp;Profits&nbsp;Greater&nbsp;Than&nbsp;"+numberWithCommas(threshold_profit)+"&nbsp;ISK",tradingStyle==REGION_HAUL&&(s+="<span id='citadelsLine'><br>* Indicates that the station is a citadel (confirm access at your own risk).</span>",s+="<br>Only showing system security status of "+$("#security-threshold").val()+" SEC or better."),1e18!==threshold_cost&&(s+=" |&nbsp;Buy&nbsp;Costs&nbsp;Less&nbsp;Than&nbsp;"+numberWithCommas(threshold_cost)+"&nbsp;ISK"),1e18!==threshold_weight&&(s+=" |&nbsp;Total&nbsp;Volume&nbsp;Under&nbsp;"+numberWithCommas(threshold_weight)+"&nbsp;m3"),a.show(),e=s+"<br/><div class='loading'></div>",o.html(e),o.show(),gtag("event","User Route Campaign",{event_category:"Route Trade Locations",event_label:t+" -> "+r,value:1})}else tradingStyle==STATION_TRADE&&(a.text("Station Trading at "+startLocations),a.show(),e="Volume greater than: "+numberWithCommas(volume_threshold)+" | Margins between "+threshold_margin_lower+"% and "+threshold_margin_upper+"%<div class='loading'>Loading. Please wait...</div>",o.html(e),o.show(),gtag("event","User Route Campaign",{event_category:"Station Trade Locations",event_label:startLocations,value:1}));n.show()}function createDataTable(){if(!tableCreated){tableCreated=!0,$("#noselect-object").html('<table id="dataTable" class="display"></table>'),$(".dataTableFilters").html("");var e=$("#dataTable");e.html("");for(var n,t="<thead>",r=tradingStyle===STATION_TRADE?stationHeader:tradingStyle===STATION_HAUL?routeHeader:regionHeader,a=0;a<r.length;a++)t+="<th>"+r[a]+"</th>";t+="</thead><tbody id='tableBody'></tbody>",e.append(t),tradingStyle==STATION_HAUL?n=e.DataTable({order:[[10,"desc"]],lengthMenu:[[50],["50"]],responsive:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"],columnDefs:[{targets:0,orderable:!1}]}):tradingStyle==REGION_HAUL?n=e.DataTable({order:[[9,"desc"]],lengthMenu:[[50],["50"]],responsive:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"],columnDefs:[{targets:0,orderable:!1}]}):tradingStyle==STATION_TRADE&&(n=e.DataTable({order:[[6,"desc"]],lengthMenu:[[50],["50"]],responsive:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf"]})),$("#dataTable thead th").each(function(e){if(0<e||tradingStyle==STATION_TRADE){var t=n.column(e).header(),r=document.createElement("button"),a=[];r.innerHTML=t.innerHTML,$(r).addClass("colvistoggle"),$(r).addClass("btn"),$(r).addClass("btn-default"),$(r).attr("colidx",e),$(r).addClass("is-true"),n.column($(r).attr("colidx")).visible(!0);for(e=0;e<a.length;e++)if(r.innerHTML===a[e]){$(r).addClass("is-false"),n.column($(r).attr("colidx")).visible(!1);break}$(r).on("click",function(e){e.preventDefault();var t=n.column($(this).attr("colidx"));$(this).removeClass("is-"+t.visible()),t.visible(!t.visible()),$(this).addClass("is-"+t.visible())});var o=document.createElement("li");$(o).append($(r)),$("#colvis").append($(o))}}),$(".dropdown").on("show.bs.dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideDown()}),$(".dropdown").on("hide.bs.dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideUp()}),$("#dataTable tbody").on("mousedown","tr",function(e){var t=0<=e.target.id.indexOf("investigate")||e.target.children[0]&&0<=e.target.children[0].id.indexOf("investigate")||e.target.classList.contains("fa");1!==e.which||t||($(this).hasClass("row-selected")?$(this).removeClass("row-selected"):$(this).addClass("row-selected"))}),$("label > input").addClass("form-control").addClass("minor-text"),$("label > input").attr("placeholder","Filter by Station/Name..."),$(".dataTableFilters").append($("#dataTable_filter")),$(".dataTableFilters").append($(".dt-buttons")),$(".dt-button").addClass("btn"),$(".dt-button").addClass("btn-default"),$(".deal_note").hide(),$("#show-hide").show(),$("#dataTable").show(),$(".dataTables_paginate").on("click",function(){$(this)[0].scrollIntoView()})}}var BUY_ORDER="buy",SELL_ORDER="sell",ALL_ORDER="all",ESI_ENDPOINT="https://esi.evetech.net",STATION_TRADE=0,STATION_HAUL=1,REGION_HAUL=2,PAGE_MULTIPLE=50,tableCreated=!1,createdRefresher=!1,totalProgress=0,executingCount=0,customBuy={},customSell={},itemCache={},citadelCache={},systemSecurity={},routeCache={},page=1,iteration=1,rowAdded=!1,orderTypeStart="SELL",orderTypeEnd="BUY",regionHeader=["","Buy Item","From","Quantity","At Sell Price","Total Cost","Take To","At Buy Price","Jumps","Profit per Jump","Total Profit","R.O.I","Total Volume (m3)"],routeHeader=["","Buy Item","From","Quantity","At Sell Price","Total Cost","Take To","At Buy Price","Gross Margin","Sell Taxes","Net Profit","Profit Per Item","R.O.I","Total Volume (m3)"],stationHeader=["Item","Buy Order","Sell Order","Profit Per Item","Margin","24-Hour Volume","14-Day Volume","30-Day Volume"],spamItems=["ahremen's","brokara's","brynn's","chelm's","cormack's","draclira's","estamel's","gotan's","hakim's","kaikka's","mizuro's","raysere's","selynne's","setele's","shaqil's","tairei's","thon's","tuvan's","vizen's","zor's"];